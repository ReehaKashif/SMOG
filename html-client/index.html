<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Smog Data for Punjab Districts</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
  <div class="container mt-5">
    <h1 class="text-center">Smog Data for Punjab Districts (October 2, 2024)</h1>
    <table class="table table-bordered mt-4">
      <thead class="thead-dark">
        <tr>
          <th>District</th>
          <th>Vehicle</th>
          <th>Industry</th>
          <th>Construction</th>
          <th>Agriculture</th>
          <th>Miscellaneous</th>
        </tr>
      </thead>
      <tbody id="district-data-table">
        <!-- Data rows will be dynamically inserted here -->
      </tbody>
    </table>
  </div>

  <script>
    // All 36 districts of Punjab
    const districts = [
      'Lahore', 'Faisalabad', 'Rawalpindi', 'Multan', 'Gujranwala', 'Sialkot',
      'Sargodha', 'Bahawalpur', 'Dera Ghazi Khan', 'Muzaffargarh', 'Rahim Yar Khan',
      'Sheikhupura', 'Kasur', 'Mianwali', 'Toba Tek Singh', 'Chiniot', 'Vehari',
      'Okara', 'Jhang', 'Hafizabad', 'Khushab', 'Pakpattan', 'Mandi Bahauddin',
      'Gujrat', 'Narowal', 'Bhakkar', 'Layyah', 'Jhelum', 'Nankana Sahib',
      'Lodhran', 'Attock', 'Khanewal', 'Bahawalnagar', 'Rajanpur', 'Chakwal'
    ];

    // Fetch data for each district and populate the table
    async function fetchDistrictData() {
      const tableBody = document.getElementById('district-data-table');
      for (const district of districts) {
        try {
          const response = await fetch(`https://smog-server.onrender.com/api/october_sources?input_date=10%2F02%2F2024&input_district=${encodeURIComponent(district)}`);
          if (!response.ok) throw new Error('Network response was not ok');
          const data = await response.json();
          
          // Create a new row for the table
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${data.district}</td>
            <td>${data.vehicle}</td>
            <td>${data.industry}</td>
            <td>${data.construction}</td>
            <td>${data.agriculture}</td>
            <td>${data.miscellaneous}</td>
          `;
          tableBody.appendChild(row);
        } catch (error) {
          console.error(`Failed to fetch data for ${district}:`, error);
        }
      }
    }

    // Call the function to fetch data and populate the table
    fetchDistrictData();
  </script>
</body>
</html>
