<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>AQI Punjab Dashboard</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
      name="viewport"
    />
    <!-- Bootstrap 3.3.7 -->
    <link
      rel="stylesheet"
      href="bower_components/bootstrap/dist/css/bootstrap.min.css"
    />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="bower_components/font-awesome/css/font-awesome.min.css"
    />
    <!-- Theme style -->
    <link rel="stylesheet" href="dist/css/AdminLTE.css" />
    <link rel="stylesheet" href="dist/css/skins/_all-skins.css" />
    <!-- Morris chart -->
    <link rel="stylesheet" href="bower_components/morris.js/morris.css" />
    <!-- jvectormap -->
    <link
      rel="stylesheet"
      href="bower_components/jvectormap/jquery-jvectormap.css"
    />
    <!-- Date Picker -->
    <link
      rel="stylesheet"
      href="bower_components/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css"
    />
    <!-- Daterange picker -->
    <link
      rel="stylesheet"
      href="bower_components/bootstrap-daterangepicker/daterangepicker.css"
    />
    <!-- bootstrap wysihtml5 - text editor -->
    <link
      rel="stylesheet"
      href="plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css"
    />
    <link rel="stylesheet" href="./dist/css/style.css" />
    <!-- Leaflet Libs -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <!-- ShapeFile Lib -->
    <script src="https://unpkg.com/shapefile@0.6.6/dist/shapefile.js"></script>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
	<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Include Moment.js -->
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1"></script>
    <!-- Include Chart.js Moment.js Adapter -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment@1.0.0"></script>

    <!-- Google Font -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic"
    />
  </head>
  <body class="hold-transition skin-blue sidebar-mini">
    <div class="wrapper">
      <header class="main-header">
        <!-- Header Navbar: style can be found in header.less -->
        <nav class="navbar navbar-static-top">
          <!-- Logo -->
          <a href="#" class="logo">
            <!-- mini logo for sidebar mini 50x50 pixels -->
            <span class="logo-mini"><b>A</b>LT</span>
            <!-- logo for regular state and mobile devices -->
            <img
              src="dist/img/logo.png"
              class="logo-image w-[100px] h-[80px] rounded-full"
            />
            <p class="uppercase">
              Punjab Information
              <br />
              Technology Board
              <br />
              <span>GOVERNMENT OF THE PUNJAB</span>
            </p>
          </a>

          <div class="navbar-custom-menu hidden">
            <ul class="nav navbar-nav">
              <!-- Notifications: style can be found in dropdown.less -->
              <li class="dropdown notifications-menu">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                  <i class="fa fa-bell-o"></i>
                  <span class="label label-warning">10</span>
                </a>
                <ul class="dropdown-menu">
                  <li class="header">You have 10 notifications</li>
                  <li>
                    <!-- inner menu: contains the actual data -->
                    <ul class="menu">
                      <li>
                        <a href="#">
                          <i class="fa fa-users text-aqua"></i> 5 new members
                          joined today
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <i class="fa fa-warning text-yellow"></i> Very long
                          description here that may not fit into the page and
                          may cause design problems
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <i class="fa fa-users text-red"></i> 5 new members
                          joined
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <i class="fa fa-shopping-cart text-green"></i> 25
                          sales made
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <i class="fa fa-user text-red"></i> You changed your
                          username
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="footer"><a href="#">View all</a></li>
                </ul>
              </li>
              <!-- Messages: style can be found in dropdown.less-->
              <li class="dropdown messages-menu">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                  <i class="fa fa-envelope-o"></i>
                  <span class="label label-success">4</span>
                </a>
                <ul class="dropdown-menu">
                  <li class="header">You have 4 messages</li>
                  <li>
                    <!-- inner menu: contains the actual data -->
                    <ul class="menu">
                      <li>
                        <!-- start message -->
                        <a href="#">
                          <div class="pull-left">
                            <img
                              src="dist/img/user2-160x160.jpg"
                              class="img-circle"
                              alt="User Image"
                            />
                          </div>
                          <h4>
                            Support Team
                            <small><i class="fa fa-clock-o"></i> 5 mins</small>
                          </h4>
                          <p>Why not buy a new awesome theme?</p>
                        </a>
                      </li>
                      <!-- end message -->
                      <li>
                        <a href="#">
                          <div class="pull-left">
                            <img
                              src="dist/img/user3-128x128.jpg"
                              class="img-circle"
                              alt="User Image"
                            />
                          </div>
                          <h4>
                            AdminLTE Design Team
                            <small><i class="fa fa-clock-o"></i> 2 hours</small>
                          </h4>
                          <p>Why not buy a new awesome theme?</p>
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <div class="pull-left">
                            <img
                              src="dist/img/user4-128x128.jpg"
                              class="img-circle"
                              alt="User Image"
                            />
                          </div>
                          <h4>
                            Developers
                            <small><i class="fa fa-clock-o"></i> Today</small>
                          </h4>
                          <p>Why not buy a new awesome theme?</p>
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <div class="pull-left">
                            <img
                              src="dist/img/user3-128x128.jpg"
                              class="img-circle"
                              alt="User Image"
                            />
                          </div>
                          <h4>
                            Sales Department
                            <small
                              ><i class="fa fa-clock-o"></i> Yesterday</small
                            >
                          </h4>
                          <p>Why not buy a new awesome theme?</p>
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <div class="pull-left">
                            <img
                              src="dist/img/user4-128x128.jpg"
                              class="img-circle"
                              alt="User Image"
                            />
                          </div>
                          <h4>
                            Reviewers
                            <small><i class="fa fa-clock-o"></i> 2 days</small>
                          </h4>
                          <p>Why not buy a new awesome theme?</p>
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="footer"><a href="#">See All Messages</a></li>
                </ul>
              </li>
              <!-- User Account: style can be found in dropdown.less -->
              <li class="dropdown user user-menu">
                <a
                  href="#"
                  class="dropdown-toggle admin"
                  data-toggle="dropdown"
                >
                  <img
                    src="dist/img/logo.svg"
                    class="user-image"
                    alt="User Image"
                  />
                  <span class="hidden-xs">Admin PITB</span>
                  <i class="fa fa-angle-down"></i>
                </a>
                <ul class="dropdown-menu">
                  <!-- User image -->
                  <li class="user-header">
                    <img
                      src="dist/img/logo.svg"
                      class="img-circle bg-white"
                      alt="User Image"
                    />
                    <p>
                      Admin - PITB
                      <small>Member since Nov. 2012</small>
                    </p>
                  </li>
                  <!-- Menu Body -->
                  <li class="user-body">
                    <div class="row">
                      <div class="col-xs-4 text-center">
                        <a href="#">Details</a>
                      </div>
                      <div class="col-xs-4 text-center">
                        <a href="#">Details</a>
                      </div>
                      <div class="col-xs-4 text-center">
                        <a href="#">Details</a>
                      </div>
                    </div>
                    <!-- /.row -->
                  </li>
                  <!-- Menu Footer-->
                  <li class="user-footer">
                    <div class="pull-left">
                      <a href="#" class="btn btn-default btn-flat">Profile</a>
                    </div>
                    <div class="pull-right">
                      <a href="#" class="btn btn-default btn-flat">Sign out</a>
                    </div>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </nav>
      </header>
      <!-- Content Wrapper. Contains page content -->
      <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header heading-bg pt-8">
          <div
            class="flex flex-col items-start lg:flex-row lg:items-end gap-8 justify-between relative"
          >
            <div>
              <img src="dist/img/banner-icon.svg" alt="User Image" />

              <div class="flex items-center gap-4">
                <p class="text-4xl lg:text-6xl font-bold">AQI in</p>
                <p class="text-4xl lg:text-6xl font-bold">
                  <select
                    id="header-district-selector"
                    class="w-fit bg-transparent border-2 border-red-500 z-[1000] cursor-pointer"
                  ></select>
                </p>
                <p class="hidden text-4xl lg:text-6xl font-bold">Pakistan</p>
              </div>
            </div>
            <div
              class="w-full lg:w-fit relative -bottom-[230px] lg:-bottom-[200px] lg:absolute lg:right-1/2 lg:translate-x-1/2 order-2 lg:order-1"
            >
              <div class="speedometer">
                <!-- Numbers -->
                <div class="numbers hidden">
                  <span class="top-1/2 -left-10 -translate-y-[75%]">0</span>
                  <span
                    class="top-1/4 left-0 -translate-x-1/2 -translate-y-[75%]"
                    >50</span
                  >
                  <span class="-top-[10px] left-[calc(50%/3)]">100</span>
                  <span class="-top-[40px] left-1/2 -translate-x-1/2">150</span>
                  <span class="-top-[10px] right-[80px] translate-x-1/2"
                    >200</span
                  >
                  <span
                    class="top-1/4 right-0 translate-x-1/2 -translate-y-[75%]"
                    >300</span
                  >
                  <span
                    class="top-1/2 -right-10 translate-x-1/2 -translate-y-[75%]"
                    >500</span
                  >
                </div>

                <!-- Color Labels -->
                <div class="labels hidden">
                  <span class="top-1/2 -left-10 -translate-y-[75%]">Good</span>
                  <span class="-top-[10px] left-[calc(50%/3)] translate-x-1/2"
                    >Moderate</span
                  >
                  <span
                    class="top-1/4 left-0 -translate-x-1/2 -translate-y-[75%]"
                    >Unhealthy for Sensitive Groups</span
                  >
                  <span class="-top-[40px] left-1/2 -translate-x-1/2"
                    >Unhealthy</span
                  >
                  <span class="-top-[10px] right-[80px] translate-x-1/2"
                    >Very Unhealthy</span
                  >
                  <span
                    class="top-1/4 right-0 translate-x-1/2 -translate-y-[75%]"
                    >Hazardous</span
                  >
                  <span
                    class="top-1/2 -right-10 translate-x-1/2 -translate-y-[75%]"
                    >Very Hazardous</span
                  >
                </div>
                <!-- AQI METER -->
                <div
                  id="aqi-average-meter-neddle"
                  class="needle"
                  style="--score: 0"
                >
                  <span
                    id="aqi-average-meter"
                    class="aqi-average font-bold text-white text-3xl md:text-4xl pointer-events-none select-none"
                  ></span>
                </div>
              </div>
              <!-- <p
                id="aqi-average"
                class="hidden text-[80px] md:text-[100px] leading-[80px] md:leading-[100px] font-bold"
              >
                -
              </p> -->
            </div>
            <div class="order-1 lg:order-2">
              <p class="text-xl md:text-3xl">Current Time</p>
              <p id="current-hour" class="text-4xl lg:text-6xl font-bold"></p>
              <p id="current-date" class="text-4xl lg:text-6xl font-bold"></p>
            </div>
          </div>
        </section>

        <!-- Main content -->
        <section class="mt-12 content space-y-8 px-4 md:px-8">
          <!-- AQI DISTRICTS -->
          <div id="aqi-status" class="row">
            <!-- BEST DISTRICT -->
            <div class="col-lg-3 col-xs-6">
              <div class="small-box">
                <div class="inner space-y-4">
                  <p class="flex items-center justify-between">
                    <span> Best Air Quality </span>
                    <a href="#">&#9900; &#9900; &#9900;</a>
                  </p>
                  <h3 class="flex items-center gap-4">
                    <span
                      id="best-district-name"
                      class="text-left !text-3xl md:!text-5xl"
                      >-</span
                    >
                    <span
                      id="best-district-aqi"
                      class="text-sm font-bold text-green-500 !text-3xl md:!text-5xl"
                      >-</span
                    >
                  </h3>
                </div>
              </div>
            </div>
            <!-- WORST DISTRICT -->
            <div class="col-lg-3 col-xs-6">
              <div class="small-box">
                <div class="inner space-y-4">
                  <p class="flex items-center justify-between">
                    <span> Worst Air Quality </span>
                    <a href="#">&#9900; &#9900; &#9900;</a>
                  </p>
                  <h3 class="flex items-center gap-4">
                    <span
                      id="worst-district-name"
                      class="text-left !text-3xl md:!text-5xl"
                      >-</span
                    >
                    <span
                      id="worst-district-aqi"
                      class="text-sm font-bold text-red-500 !text-3xl md:!text-5xl"
                      >-</span
                    >
                  </h3>
                </div>
              </div>
            </div>
            <!-- HIGHEST POLLUTANT DISTRICT -->
            <div class="col-lg-3 col-xs-6">
              <div class="small-box">
                <div class="inner space-y-4">
                  <p class="flex items-center justify-between">
                    <span> Highest Pollutant </span>
                    <a href="#">&#9900; &#9900; &#9900;</a>
                  </p>
                  <h3
                    id="highest-pollutant-district"
                    class="text-left !text-3xl md:!text-5xl"
                  >
                    -
                  </h3>
                </div>
              </div>
            </div>
            <!-- CAUSE OF POLLUTANT -->
            <div class="col-lg-3 col-xs-6">
              <div class="small-box">
                <div class="inner space-y-4">
                  <p class="flex items-center justify-between">
                    <span> Cause of Pollutant </span>
                    <a href="#">&#9900; &#9900; &#9900;</a>
                  </p>
                  <h3
                    id="cause-of-pollutant"
                    class="text-left !text-3xl md:!text-5xl"
                  >
                    -
                  </h3>
                </div>
              </div>
            </div>
          </div>
          <!-- AQI METER & COLOUR PALLETE -->
          <div
            class="hidden w-full flex flex-col lg:flex-row gap-12 lg:h-[450px] lg:max-h-[450px]"
          >
            <section class="h-full w-full lg:w-1/2">
              <!-- Custom tabs (Charts with tabs)-->
              <div class="h-full nav-tabs-custom overflow-hidden">
                <!-- Tabs within a box -->
                <ul class="nav nav-tabs pull-right no-border lg:h-[25px]">
                  <li class="pull-left header">
                    <h3><span>AQI</span> in Punjab, Pakistan</h3>
                  </li>
                </ul>
                <div class="tab-content no-padding lg:h-[calc(100%-65px)] py-8">
                  <img
                    src="dist/img/meter.svg"
                    class="user-image mx-auto hidden"
                    alt="User Image "
                  />
                  <div class="speedometer translate-y-20 lg:translate-y-32">
                    <div
                      id="aqi-average-meter-neddle"
                      class="needle"
                      style="--score: 0"
                    >
                      <span
                        id="aqi-average-meter"
                        class="aqi-average font-bold text-white text-3xl md:text-4xl pointer-events-none select-none"
                      ></span>
                    </div>
                  </div>
                </div>
                <div class="map-disclaimer lg:h-[50px] relative">
                  <p style="font-size: medium">
                    <span style="font-weight: 700; text-decoration: underline">
                      Disclaimer:
                    </span>
                    The map represents AQI levels in Punjab, Pakistan, using
                    color-coded ranges to indicate the quality of air in
                    different districts.
                  </p>
                </div>
              </div>
            </section>
            <!--  -->
            <section class="h-full w-full lg:w-1/2">
              <!-- Custom tabs (Charts with tabs) -->
              <div class="h-full nav-tabs-custom">
                <!-- Tabs within a box -->
                <ul class="nav nav-tabs pull-right no-border lg:h-[25px]">
                  <li class="pull-left header">
                    <h3><span>Colour</span> pallete</h3>
                  </li>
                </ul>

                <div
                  class="lg:h-[calc(100%-25px)] flex items-start flex-col justify-between"
                >
                  <div id="color-palette" class="w-full py-8"></div>

                  <div class="map-disclaimer">
                    <p style="font-size: medium">
                      <span style="font-weight: 700; text-decoration: underline"
                        >Disclaimer:
                      </span>
                      The map provides a visual representation of the air
                      quality levels across various districts in Punjab,
                      Pakistan, using a color-coded system to rank each district
                      based on its Air Quality Index (AQI).
                    </p>
                  </div>
                </div>
              </div>
            </section>
          </div>
		  		<style>
				/* Remove horizontal overflow */
				html, body {
					margin: 0;
					padding: 0;
					overflow-x: hidden;
				}
				/* Full-width container */
				.container {
					width: 100%;
					max-width: 100%;
					margin: 0 auto;
					padding: 5px;
				}
				.row {
					border: 2px solid #e2e8f0;
					border-radius: 1rem;
					box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
					padding: 20px;
					width: 100%;
					margin: 0;
					box-sizing: border-box;
				}
				.nav-tabs-custom {
					display: flex;
					justify-content: space-between;
					align-items: center;
					margin-bottom: 10px;
				}
				.chart-container {
					position: relative;
					width: 100%;
					height: 300px;
					margin: auto;
				}
				.header {
					font-weight: bold;
					font-size: 1.875rem;
					color: #000;
				}
				.dropdown {
					padding: 5px;
					border-radius: 0.25rem;
					border: 1px solid #e2e8f0;
				}
				.chart {
					width: 100%;
					height: 100%;
				}
			</style>
			<!-- Main row -->
			<div class="container">
				<div class="row">
					<!-- Prediction Chart -->
					<section class="col-lg-12">
						<div class="nav-tabs-custom">
							<!-- Header and Dropdown -->
							<h3 class="header">Min/Max AQI Prediction</h3>
							<select id="predictionDistrictSelect" class="dropdown" onchange="fetchAQIPredictionData()">
								<!-- Options here -->
								<option value="Attock">Attock</option>
								<option value="Bahawalnagar">Bahawalnagar</option>
								<option value="Bahawalpur">Bahawalpur</option>
								<option value="Bhakkar">Bhakkar</option>
								<option value="Chakwal">Chakwal</option>
								<option value="Chiniot">Chiniot</option>
								<option value="Dera Ghazi Khan">Dera Ghazi Khan</option>
								<option value="Faisalabad">Faisalabad</option>
								<option value="Gujranwala">Gujranwala</option>
								<option value="Gujrat">Gujrat</option>
								<option value="Hafizabad">Hafizabad</option>
								<option value="Jhang">Jhang</option>
								<option value="Jhelum">Jhelum</option>
								<option value="Kasur">Kasur</option>
								<option value="Khanewal">Khanewal</option>
								<option value="Khushab">Khushab</option>
								<option value="Lahore" selected>Lahore</option>
								<option value="Layyah">Layyah</option>
								<option value="Lodhran">Lodhran</option>
								<option value="Mandi Bahuddin">Mandi Bahuddin</option>
								<option value="Mianwali">Mianwali</option>
								<option value="Multan">Multan</option>
								<option value="Muzaffargarh">Muzaffargarh</option>
								<option value="Nankana Sahib">Nankana Sahib</option>
								<option value="Narowal">Narowal</option>
								<option value="Okara">Okara</option>
								<option value="Pakpattan">Pakpattan</option>
								<option value="Rahim Yar Khan">Rahim Yar Khan</option>
								<option value="Rajanpur">Rajanpur</option>
								<option value="Rawalpindi">Rawalpindi</option>
								<option value="Sahiwal">Sahiwal</option>
								<option value="Sargodha">Sargodha</option>
								<option value="Sheikhupura">Sheikhupura</option>
								<option value="Sialkot">Sialkot</option>
								<option value="Toba Tek Singh">Toba Tek Singh</option>
								<option value="Vehari">Vehari</option>
							</select>
						</div>
						<!-- Chart -->
						<div class="chart-container">
							<canvas id="minMaxAQIChart" class="chart"></canvas>
						</div>
					</section>
				</div>
			</div>
			    <script src="https://cdn.jsdelivr.net/npm/luxon@2.3.0/build/global/luxon.min.js"></script>

				<!-- Add this before including the Chart.js script -->
				


<!-- Include Date Adapter (chartjs-adapter-date-fns) before Chart.js -->

	



    </head>
        <!-- Main row -->
        <div class="container">
            <div class="row">
                <!-- Max Hourly AQI Chart -->
                <section class="col-lg-12">
                    <!-- Chart Header and Dropdown in Flex Container -->
                    <div class="header-container">
                        <h3 class="header">Max Hourly AQI - Last 24 Hours</h3>
                        <select id="districtSelect" class="dropdown" onchange="fetchMaxAQIData()">
                            <option value="Attock">Attock</option>
                            <option value="Lahore" selected>Lahore</option>
                            <option value="Bahawalnagar">Bahawalnagar</option>
                            <option value="Bahawalpur">Bahawalpur</option>
                            <option value="Bhakkar">Bhakkar</option>
                            <option value="Chakwal">Chakwal</option>
                            <option value="Chiniot">Chiniot</option>
                            <option value="Dera Ghazi Khan">Dera Ghazi Khan</option>
                            <option value="Faisalabad">Faisalabad</option>
                            <option value="Gujranwala">Gujranwala</option>
                            <option value="Gujrat">Gujrat</option>
                            <option value="Hafizabad">Hafizabad</option>
                            <option value="Jhang">Jhang</option>
                            <option value="Jhelum">Jhelum</option>
                            <option value="Kasur">Kasur</option>
                            <option value="Khanewal">Khanewal</option>
                            <option value="Khushab">Khushab</option>
                            <option value="Layyah">Layyah</option>
                            <option value="Lodhran">Lodhran</option>
                            <option value="Mandi Bahuddin">Mandi Bahuddin</option>
                            <option value="Mianwali">Mianwali</option>
                            <option value="Multan">Multan</option>
                            <option value="Muzaffargarh">Muzaffargarh</option>
                            <option value="Nankana Sahib">Nankana Sahib</option>
                            <option value="Narowal">Narowal</option>
                            <option value="Okara">Okara</option>
                            <option value="Pakpattan">Pakpattan</option>
                            <option value="Rahim Yar Khan">Rahim Yar Khan</option>
                            <option value="Rajanpur">Rajanpur</option>
                            <option value="Rawalpindi">Rawalpindi</option>
                            <option value="Sahiwal">Sahiwal</option>
                            <option value="Sargodha">Sargodha</option>
                            <option value="Sheikhupura">Sheikhupura</option>
                            <option value="Sialkot">Sialkot</option>
                            <option value="Toba Tek Singh">Toba Tek Singh</option>
                            <option value="Vehari">Vehari</option>
                        </select>
                    </div>
                    <!-- Chart -->
                    <div class="chart-container">
                        <canvas id="aqiChart" class="chart"></canvas>
                    </div>
                </section>
            </div>
        </div>
    
 

          <div class="row">
            <section class="col-lg-6">
              <div class="nav-tabs-custom">
                <!-- Tabs within a box -->
                <ul class="nav nav-tabs pull-right no-border mb20">
                  <li class="pull-left header">
                    <h3><span>Districts</span> AQI</h3>
                  </li>
                </ul>
                <div
                  id="map1"
                  class="relative w-full h-[700px] tab-content no-padding"
                >
                  <div class="district-aqi-map-legend hidden">
                    <p class="legend hidden">Legend</p>
                    <div class="district-aqi-map-legend-item">
                      <div style="background-color: #00e400">
                        <span>0-50 Good</span>
                        <span>Low AQI</span>
                      </div>
                    </div>
                    <div class="district-aqi-map-legend-item">
                      <div style="background-color: #ffff00">
                        <span> 51-100 Moderate</span>
                        <div class="legend-arrow"></div>
                      </div>
                    </div>
                    <div class="district-aqi-map-legend-item double-height">
                      <div style="background-color: #ff7e00">
                        <span>
                          101-150 Unhealthy for <br />Sensitive Groups
                          (USG)</span
                        >
                        <div class="legend-arrow double-height"></div>
                      </div>
                    </div>
                    <div class="district-aqi-map-legend-item">
                      <div style="background-color: #ff0000">
                        <span> 151-200 Unhealthy</span>
                        <div class="legend-arrow"></div>
                      </div>
                    </div>
                    <div class="district-aqi-map-legend-item">
                      <div style="background-color: #8f3f97">
                        <span> 201-300 Very Unhealthy</span>
                        <div class="legend-arrow"></div>
                      </div>
                    </div>
                    <div class="district-aqi-map-legend-item">
                      <div style="background-color: #7e0023">
                        <span> 301-500 Hazardous</span>
                        <div class="legend-arrow legend-arrow-head"></div>
                      </div>
                    </div>
                    <div class="district-aqi-map-legend-item">
                      <div style="background-color: #767171">
                        <span> >501 Very Hazardous</span>
                        <span>High AQI</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </section>
            <section class="col-lg-6">
              <!-- Custom tabs (Charts with tabs)-->
              <div class="nav-tabs-custom">
                <!-- Tabs within a box -->
                <ul class="nav nav-tabs pull-right no-border mb20">
                  <li class="pull-left header">
                    <h3><span>Districts</span> Rankings</h3>
                  </li>
                </ul>
                <div
                  id="map2"
                  class="relative w-full h-[700px] tab-content no-padding"
                >
                  <div
                    id="district-rankings-map-legend"
                    class="district-rankings-map-legend hidden"
                  >
                    <p class="legend hidden">Legend</p>
                  </div>
                </div>
              </div>
              <!-- /.nav-tabs-custom -->
            </section>
          </div>
          <!-- Main row -->
          <div class="row border-2 rounded-xl shadow-sm">
            <!-- Prediction Chart -->
            <section class="col-lg-12">
              <div class="nav-tabs-custom border-0 shadow-none">
                <!-- Tabs within a box -->
                <ul class="flex items-center justify-between border-0 h-[45px]">
                  <li>
                    <h3 class="text-black font-bold text-3xl">Prediction</h3>
                  </li>
                  <li>
                    <select id="predition-district-selector" class="form-control"></select>
                  </li>
                </ul>
                <!-- chartRightCanva -->
                <div class="relative w-full chart tab-panel">
                  <canvas
                    id="predictionChart"
                    class="w-full max-h-[300px]"
                  ></canvas>
                </div>
              </div>
            </section>
          </div>

          <!-- <div class="row border-2 rounded-xl shadow-sm">
            <section class="col-lg-6">
              <div class="nav-tabs-custom border-0 shadow-none">
                
                <ul class="flex items-center justify-between border-0 h-[45px]">
                  <li>
                    <h3 class="text-black font-bold text-3xl">
                      Actual vs Prediction
                    </h3>
                  </li>
                  <li>
                    <select
                      id="district-selector"
                      class="form-control"
                    ></select>
                  </li>
                </ul>
                
                <div class="relative w-full chart tab-pane">
                  <canvas id="chartLeftCanva" class="w-full h-[400px]"></canvas>
                </div>
              </div>
            </section>
            
            <section class="col-lg-6">
              <div class="nav-tabs-custom border-0 shadow-none">
            
                <ul class="flex items-center justify-between border-0 h-[45px]">
                  <li>
                    <h3 class="text-black font-bold text-3xl">Prediction</h3>
                  </li>
                  <li class="text-black">
                    <a href="#">&#9900; &#9900; &#9900;</a>
                  </li>
                </ul>
            
                <div class="relative w-full chart tab-pane">
                  <canvas
                    id="chartRightCanva"
                    class="w-full h-[400px]"
                  ></canvas>
                </div>
              </div>
            </section>
          </div> -->




          <div class="row">
            <div class="h-full">
              <div class="nav-tabs-custom legend-source-option">
                <!-- Tabs within a box -->
                <ul class="nav nav-tabs pull-right no-border mb20">
                  <li class="pull-left header">
                    <h3><span>Major Causes of Smog</span></h3>
                  </li>
                </ul>
                <div class="row mb20">
				
				
                  <section class="col-lg-12 cause-section">
				<!-- code start here  -->
                    <label for="date">Select a Date:</label>
					<input type="date" id="date-picker">
					<br><br>
					<label for="rankSelect">Select Pollutant Rank:</label>
					<select id="source-ranking">
						<option value="top">Top Pollutant</option>
						<option value="second">Second Top Pollutant</option>
						<option value="third">Third Top Pollutant</option>
					</select>
					<br><br>
					
                  </section>
				  <!-- end here  -->
                  <section style="margin-top: 16px" class="col-lg-12">
                    <p
                      style="float: left; margin-right: 10px; line-height: 25px"
                    >
                      Sources:
                    </p>
                    <div class="industry-1 btn-flat flex items-center gap-4">
                      <img
                        src="dist/img/icon1.svg"
                        class="user-image"
                        alt="User Image"
                      />
                      Vehicle
                    </div>
                    <div class="industry-2 btn-flat flex item">
                      <img
                        src="dist/img/icon2.svg"
                        class="user-image"
                        alt="User Image"
                      />
                      Industry
                    </div>
                    <div class="industry-3 btn-flat flex item">
                      <img
                        src="dist/img/icon3.svg"
                        class="user-image"
                        alt="User Image"
                      />
                      Construction
                    </div>
                    <div
                      class="industry-4 btn-flat flex item"
                      style="background-color: #FFC1070; border-color: #FFC107"
                    >
                      <img
                        src="dist/img/icon4.svg"
                        class="user-image"
                        alt="User Image"
                      />
                      Agriculture
                    </div>
                    <div class="industry-5 btn-flat flex item">
                      <img
                        src="dist/img/icon5.svg"
                        class="user-image"
                        alt="User Image"
                      />
                      Residential
                    </div>
                  </section>
                </div>
				  <div class="form-group">
					<label>Select Types:</label><br>
					<input type="checkbox" id="brickKlinCheckbox" value="BrickKlin" /> <span style="color: brown;">BrickKlin</span>
					<input type="checkbox" id="factoriesCheckbox" value="Factories" /> <span style="color: blue;">Factories</span>
					<input type="checkbox" id="parksCheckbox" value="Parks" /> <span style="color: green;">Parks</span>
				  </div>
                <!-- Forecast Chart -->
                <div>
                  <div
                    id="forecastMap"
                    style="height: 750px; position: relative"
                    class="w-full tab-content no-padding"
                  >
                  </div>
                </div>
              </div>
            </div>
          </div>
           <!-- 
          <div class="row">
            <div class="h-full">
              <div class="nav-tabs-custom legend-source-option"> -->
                <!-- Tabs within a box -->
                <!--<ul class="nav nav-tabs pull-right no-border mb20">
                  <li class="pull-left header">
                    <h3><span>Major Causes of Smog</span></h3>
                  </li>
                </ul>
                <div class="row mb20">
                  <section class="col-lg-12 cause-section">
                    <select id="pollutant-source-selector" class="form-control">
                      <option value="All">All</option>
                      <option value="Vehicle">Vehicles</option>
                      <option value="Industry">Industry</option>
                      <option value="Construction">Construction</option>
                      <option value="Agriculture">Agriculture</option>
                      <option value="Miscellaneous">Miscellaneous</option>
                    </select>
                  </section>
                  <section style="margin-top: 16px" class="col-lg-12">
                    <p
                      style="float: left; margin-right: 10px; line-height: 25px"
                    >
                      Sources:
                    </p>
                    <div class="industry-1 btn-flat flex items-center gap-4">
                      <img
                        src="dist/img/icon1.svg"
                        class="user-image"
                        alt="User Image"
                      />
                      Vehicle
                    </div>
                    <div class="industry-2 btn-flat flex item">
                      <img
                        src="dist/img/icon2.svg"
                        class="user-image"
                        alt="User Image"
                      />
                      Industry
                    </div>
                    <div class="industry-3 btn-flat flex item">
                      <img
                        src="dist/img/icon3.svg"
                        class="user-image"
                        alt="User Image"
                      />
                      Construction
                    </div>
                    <div
                      class="industry-4 btn-flat flex item"
                      style="background-color: #36454f50; border-color: #36454f"
                    >
                      <img
                        src="dist/img/icon4.svg"
                        class="user-image"
                        alt="User Image"
                      />
                      Agriculture
                    </div>
                    <div class="industry-5 btn-flat flex item">
                      <img
                        src="dist/img/icon5.svg"
                        class="user-image"
                        alt="User Image"
                      />
                      Miscellaneous
                    </div>
                  </section>
                </div> -->
                <!-- Forecast Chart -->
                <!-- <div>
                  <div
                    id="forecastMap"
                    style="height: 750px; position: relative"
                    class="w-full tab-content no-padding"
                  >
                  </div>
                </div>
              </div>
            </div>
          </div> -->
          <!-- /.row (main row) -->
          <div class="row border-2 rounded-xl shadow-sm">
            <!-- <div class="relative w-full chart tab-panel"> -->
              <section class="col-lg-12">
                <div class="nav-tabs-custom border-0 shadow-none">
                  <!-- Tabs within a box -->
                  <ul class="flex items-center justify-between border-0 h-[45px]">
                    <li>
                      <h3 class="text-black font-bold text-3xl">Greenery Percentage</h3>
                    </li>
                    <li>
                      <select id="greenery-district-selector" class="form-control">
                        <option>Punjab</option>
                      </select>
                    </li>
                  </ul>
                  <!-- chartRightCanva -->
                  <div class="relative w-full chart tab-panel">
                    <canvas
                      id="greeneryChart"
                      class="w-full max-h-[300px]"
                    ></canvas>
                  </div>
                </div>
              </section>
              
            <!-- </div> -->
            <!-- <img src="dist/img/bar.jpg" alt="map" class="w-full h-full" /> -->
          </div>
        </section>
        <!-- /.content -->
      </div>
      <!-- /.content-wrapper -->
      <!-- <footer class="main-footer">
        <strong>
          Copyright &copy; 2024-2025 <a href="#">Powered By Punjab IT Board</a>
        </strong>
      </footer> -->
    </div>
    <!-- ./wrapper -->

    <!-- jQuery 3 -->
    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <!-- jQuery UI 1.11.4 -->
    <script src="bower_components/jquery-ui/jquery-ui.min.js"></script>
    <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
    <script>
      $.widget.bridge("uibutton", $.ui.button);
    </script>
    <!-- Bootstrap 3.3.7 -->
    <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <!-- Morris.js charts -->
    <script src="bower_components/raphael/raphael.min.js"></script>
    <script src="bower_components/morris.js/morris.min.js"></script>
    <!-- Sparkline -->
    <script src="bower_components/jquery-sparkline/dist/jquery.sparkline.min.js"></script>
    <!-- jvectormap -->
    <script src="plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
    <script src="plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
    <!-- jQuery Knob Chart -->
    <script src="bower_components/jquery-knob/dist/jquery.knob.min.js"></script>
    <!-- daterangepicker -->
    <script src="bower_components/moment/min/moment.min.js"></script>
    <script src="bower_components/bootstrap-daterangepicker/daterangepicker.js"></script>
    <!-- datepicker -->
    <script src="bower_components/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
    <!-- Bootstrap WYSIHTML5 -->
    <script src="plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js"></script>
    <!-- Slimscroll -->
    <script src="bower_components/jquery-slimscroll/jquery.slimscroll.min.js"></script>
    <!-- FastClick -->
    <script src="bower_components/fastclick/lib/fastclick.js"></script>
    <!-- AdminLTE App -->
    <script src="dist/js/adminlte.min.js"></script>
    <!-- AdminLTE dashboard demo (This is only for demo purposes) -->
    <script src="dist/js/pages/dashboard.js"></script>
    <!-- Chart.Js CDN -->

    <!-- AdminLTE for demo purposes -->
    <script src="dist/js/demo.js"></script>
    <!-- CUSTOM SCRIPTS START HERE -->
    <!-- Custom Script to handle Shapes on Map -->
    <script src="dist/js/lib/shapefile.js"></script>
    <script src="dist/js/lib/pollutant-data.js"></script>
    <script src="dist/js/lib/pollutant-calculations.js"></script>
    <script src="dist/js/api/index.js"></script>
    <script src="dist/js/api/chart.js"></script>
    <script src="dist/js/api/district.js"></script>
    <script src="dist/js/api/map.js"></script>

    <!-- Include Leaflet.js CSS and JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <!-- Include Terraformer and parsers -->
    <script src="https://unpkg.com/terraformer@1.0.8"></script>
    <script src="https://unpkg.com/terraformer-wkt-parser@1.1.2"></script>

	<script>
      // Initialize the map
      const map = L.map('forecastMap').setView([31.5, 73.0], 7);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 18,
        attribution: 'Map data © OpenStreetMap contributors'
      }).addTo(map);

      // Function to get today's date in 'YYYY-MM-DD' format
       function getCurrentDate() {
        const today = new Date();
        const year = today.getFullYear();
        const month = String(today.getMonth() + 1).padStart(2, '0');
        const day = String(today.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
  }

      // Load GeoJSON data for district boundaries
      fetch('districts_geojson.geojson')
        .then(response => response.json())
        .then(data => {
          // Store the GeoJSON layer for later access
          const geoJsonLayer = L.geoJSON(data, {
            style: function (feature) {
              return {
                color: 'grey',
                weight: 2,
                opacity: 0.8,
                fillOpacity: 0.4
              };
            }
          }).addTo(map);

          // Update district data based on date and source ranking
          async function updateDistrictData(date, ranking = 'top') {
            const formattedDate = new Date(date).toLocaleDateString('en-US');

            // Iterate through existing GeoJSON features and update their style & popups
            data.features.forEach(async (feature) => {
              const district = feature.properties.district;

              if (!district) {
                console.warn('Feature does not have a district name:', feature);
                return; // Skip processing if the district name is missing
              }

              try {
                const response = await fetch(`https://smog-aqi-server.onrender.com/api/october_sources?input_date=${encodeURIComponent(formattedDate)}&input_district=${encodeURIComponent(district)}`);
                
                if (!response.ok) {
                  console.error(`Network response for ${district} was not ok`);
                  return;
                }

                const data = await response.json();
                if (!data || !data.Sum_of_Sources) {
                  console.warn(`Data for ${district} is incomplete or missing:`, data);
                  return; // Skip this district if data is incomplete
                }

                // Determine the color and source value based on ranking
                const sources = [
                  { name: 'Vehicles', value: data.Vehicle || 0, percent: data['Vehicle%'] || 0, color: "#b3294e" },
                  { name: 'Industry', value: data.Industry || 0, percent: data['Industry%'] || 0, color: "#2196F3" },
                  { name: 'Agriculture', value: data.Agriculture || 0, percent: data['Agriculture%'] || 0, color: "#FFC107" },
                  { name: 'Construction', value: data.Construction || 0, percent: data['Construction%'] || 0, color: "#FF5722" },
                  { name: 'ResidentialHeat', value: data.Residential || 0, percent: data['Residential%'] || 0, color: "#6d319e" },
                  { name: 'Misc', value: data.Misc || 0, percent: data['Misc%'] || 0, color: "#9E9E9E" }
                ];

                sources.sort((a, b) => b.percent - a.percent);

                let selectedSource;
                if (ranking === 'top') selectedSource = sources[0];
                else if (ranking === 'second') selectedSource = sources[1];
                else if (ranking === 'third') selectedSource = sources[2];

                if (!selectedSource) {
                  console.warn(`No source data found for ${district}`);
                  return;
                }

                // Update the style of the existing feature
                const layer = geoJsonLayer.getLayers().find(l => l.feature.properties.district === district);
                if (layer) {
                  layer.setStyle({ color: selectedSource.color, weight: 2, opacity: 0.8, fillOpacity: 0.4 });

                  // Update the popup content dynamically
                  const popupContent = `
                    <div>
                      <strong>District:</strong> ${district}<br/>
                      <table class="table table-bordered mt-2">
                        <thead>
                          <tr>
                            <th>Source</th>
                            <th>Value</th>
                            <th>%</th>
                          </tr>
                        </thead>
                        <tbody>
                          ${sources.map(source => `<tr><td>${source.name}</td><td>${source.value.toFixed(0)}</td><td>${source.percent.toFixed(0)}%</td></tr>`).join('')}
                        </tbody>
                      </table>
                    </div>
                  `;

                  // Update the popup
                  layer.bindPopup(popupContent);
                }
              } catch (error) {
                console.error(`Failed to fetch data for ${district}:`, error);
              }
            });
          }

          // Automatically set the date to today and update the data
            const currentDate = getCurrentDate();
            document.getElementById('date-picker').value = currentDate;
            updateDistrictData(currentDate, 'top');


          // Event listener for date and source ranking change
          document.getElementById('date-picker').addEventListener('change', function() {
            const selectedDate = this.value;
            const selectedRanking = document.getElementById('source-ranking').value;
            if (selectedDate) {
              // Update the data without removing layers
              updateDistrictData(selectedDate, selectedRanking);
            }
          });

          document.getElementById('source-ranking').addEventListener('change', function() {
            const selectedDate = document.getElementById('date-picker').value;
            const selectedRanking = this.value;
            if (selectedDate) {
              // Update the data without removing layers
              updateDistrictData(selectedDate, selectedRanking);
            }
          });
        })
        .catch(error => console.error('Error loading GeoJSON data:', error));
		////////////////////////////////////////
		      // Function to place small colored circle markers on the map
			  function placeColoredMarkers(longitudes, latitudes, type) {
				const color = type === 'Factories' ? 'blue' : (type === 'BrickKlin' ? 'brown' : 'green');

				for (let i = 0; i < longitudes.length; i++) {
				  const lat = parseFloat(latitudes[i]);
				  const lon = parseFloat(longitudes[i]);
				  if (!isNaN(lat) && !isNaN(lon)) {
					L.circleMarker([lat, lon], {
					  color: color,
					  radius: 1, // Small dot marker
					  fillOpacity: 0.4,
					}).addTo(map);
				  }
				}
			  }
		
		      // Function to fetch data based on selected type
		  async function fetchData(type) {
			try {
			  const response = await fetch(`https://smog-aqi-server.onrender.com/api/miscellaneous_pts/?Type=${type}`);
			  if (!response.ok) throw new Error('Network response was not ok');
			  const data = await response.json();
			  return data;
			} catch (error) {
			  console.error('Error fetching data:', error);
			  return [];
			}
		  }

		  // Function to update markers based on selected checkboxes
		  async function updateMarkers() {
			// Clear existing markers
			map.eachLayer(layer => {
			  if (layer instanceof L.Marker || layer instanceof L.CircleMarker) map.removeLayer(layer);
			});

			// Add markers for selected types
			if (document.getElementById('brickKlinCheckbox').checked) {
			  const brickKlinData = await fetchData('BrickKlin');
			  if (brickKlinData && typeof brickKlinData === 'object') {
				placeColoredMarkers(brickKlinData.Longitude, brickKlinData.Latitude, 'BrickKlin');
			  }
			}
			if (document.getElementById('factoriesCheckbox').checked) {
			  const factoriesData = await fetchData('Factories');
			  if (factoriesData && typeof factoriesData === 'object') {
				placeColoredMarkers(factoriesData.Longitude, factoriesData.Latitude, 'Factories');
			  }
			}
			if (document.getElementById('parksCheckbox').checked) {
			  const parksData = await fetchData('Parks');
			  if (parksData && typeof parksData === 'object') {
				placeColoredMarkers(parksData.Longitude, parksData.Latitude, 'Parks');
			  }
			}
		  }

		  // Event listeners for checkboxes
		  document.getElementById('brickKlinCheckbox').addEventListener('change', updateMarkers);
		  document.getElementById('factoriesCheckbox').addEventListener('change', updateMarkers);
		 document.getElementById('parksCheckbox').addEventListener('change', updateMarkers);
    </script>

    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
        }
        #map-container {
            width: 80%;
            height: 80vh;
            margin: 20px auto;
            border: 1px solid #ccc;
            position: relative;
            overflow: hidden;
        }
        #map-frame {
            width: 100%;
            height: 100%;
            border: none;
            opacity: 1;
            transition: opacity 0.5s ease-in-out;
            position: absolute;
            top: 0;
            left: 0;
        }
        #year-label {
            font-size: 24px;
            font-weight: bold;
            margin-top: 10px; /* Adjusted margin for better spacing */
        }
        #slider-container {
            width: 50%; /* Decreased width of slider container */
            margin: 20px auto; /* Centered the slider container */
            position: relative; /* Added for better positioning */
            top: 0; /* Adjusted to position at the top */
            z-index: 1; /* Make sure slider is on top of other elements */
        }
        #year-slider {
            width: 100%;
            height: 20px; /* Adjusted height for a smaller slider */
            -webkit-appearance: none; /* Remove default styling */
            background: #ddd; /* Slider track color */
            border-radius: 5px; /* Rounded corners for slider track */
        }
        #year-slider::-webkit-slider-thumb {
            -webkit-appearance: none; /* Remove default styling */
            appearance: none; /* Remove default styling */
            width: 20px; /* Size of the slider thumb */
            height: 20px; /* Size of the slider thumb */
            border-radius: 50%; /* Rounded thumb */
            background: #4CAF50; /* Thumb color */
            cursor: pointer; /* Cursor style */
        }
    </style>

		<h1>Forest Cover Maps by Year</h1>
			<p id="year-label">Year: <span id="current-year">2016</span></p>

			<div id="slider-container">
				<!-- Range input slider for year selection -->
				<input type="range" id="year-slider" min="2016" max="2024" value="2016" step="1" oninput="updateMap(this.value)">
			</div>

			<div id="map-container">
				<iframe id="map-frame" src="output_html_maps/forest_cover_2016.html"></iframe>
			</div>

			<script>
				const mapFrame = document.getElementById('map-frame');
				const currentYearLabel = document.getElementById('current-year');
				const yearSlider = document.getElementById('year-slider');

				// Function to update map based on slider value
				function updateMap(year) {
					currentYearLabel.innerText = year;
					mapFrame.style.opacity = 0; // Fade out

					setTimeout(() => {
						mapFrame.src = `output_html_maps/forest_cover_${year}.html`;
						mapFrame.onload = () => {
							mapFrame.style.opacity = 1; // Fade back in after loading new map
						};
					}, 500); // Wait for fade-out before changing the source
				}

				// Initialize the map with the starting year from the slider
				document.addEventListener("DOMContentLoaded", () => {
					updateMap(yearSlider.value);
				});
			</script>

  
  </body>
</html>
